<!DOCTYPE html>
<html language="english">
<head>
<title>LODQA for SNOMED-CT@BioPortal</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<link href="css/ontofinder.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript">
  function addvid(vid) {
    document.getElementById("vids").value += " " + vid;
  }
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" src="js/sparql.js"></script>
<script type="text/javascript">
  var bioportal = new SPARQL({ 
    apikey: "4d9b44c5-5aad-4c3e-9692-e7490b860896", 
    endpoint: "http://sparql.bioontology.org/sparql/"
  });

  function onFailure(xhr, status) {
    $('#loading').toggle();
    document.getElementById("result").innerHTML = status + " (See console.)";
    console.log("error");
    console.log(xhr);
  }

  function onSuccess(json) {
    $('#loading').toggle();
    var html = "<table border='1'>";
    for (var b in json.results.bindings) {
      html += "<tr>";
      for (var x in json.head.vars) { 
        var value = json.results.bindings[b][json.head.vars[x]];
        if (value.type == "uri")
          html += "<td><a href='"+value.value+"'>" + value.value + "</a></td>";
        else
          html += "<td>" + value.value + "</td>";
      }
      html += "</tr>";
    }
    html += "</table>";
    document.getElementById("result").innerHTML = html;
  }

  function enquire()
  {
    $('#loading').toggle();
    var query = document.getElementById("sparql").value;
    bioportal.query(query).done(onSuccess).error(onFailure);
  }
</script>

</head>
<body>
<h1>LODQA for SNOMED-CT@BioPortal</h1>

<table class="frame">
<thead>
<tr><td>powered by <a href="http://www-tsujii.is.s.u-tokyo.ac.jp/enju/">Enju</a>, a HPSG parser.</tr>
</thead>
<tr><th>Query</th></tr>
</table>
<div class="atext"><%= atext %></div>
<br/>

<table class="frame">
<tr><th>Semantic analysis (predicate-argument relation graph)</th></tr>
</table>
<img src="./temporary/_pas_graph.png">


<table class="frame">
<tr><th>Pesudo SPARQL</th></tr>
</table>
<div class="frame"><pre><%= psparql %></pre></div>
<br/>


<form name="query" method="post"
      action="http://ontofinder.dbcls.jp/ontofinder.cgi"
      entype="multipart/form-data">
<table class="frame">
<tr><th>SPARQL</th></tr>
<tr>
<td><textarea id="sparql" name="sparql" maxlength="1200" required="required" style="height:100px; width:100%"><%= sparql %></textarea></td>
</tr>
<!--tr>
<td><input type="submit" value="SUBMIT (to the BioPortal SPARQL endpoint)" style="height: 50px; width: 100%" /></td>
</tr-->
</table>
</form>

<table class="frame">
<tr><th>Results</th></tr>
<tr><td><button type="button" onclick="enquire()">get results</button><image id="loading" src="image/loader-vflff1Mjj.gif"></td></tr>
</table>
<div class="frame" id="result"></div>
<br/>


<form name="query" method="post"
      action="http://ontofinder.dbcls.jp/ontofinder.cgi"
      entype="multipart/form-data">
<table class="frame">
<tr><th>Mapping to ontologies (demo stops after calling OntoFinder)</th></tr>
<tr>
<td><textarea id="data" name="data" maxlength="1200" required="required" style="height:100px; width:100%"><%= terms %></textarea></td>
</tr>

<tr><td>
Ontologies to be searched:<br/><input id="vids" type="text" name="vids" size="80" style="width:100%"
placeholder="space-separated vids (none to search all ontologies)" />
</td></tr>

<tr><td>
Example ontologies (click to add):
<table class="list">
<tr><th>vid</th>  <th>acronym</th>  <th>name</th></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1109</a></td> <td>SO</td>        <td>Sequence types and features</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1062</a></td> <td>PR</td>        <td>PRotein Ontology (PRO)</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1029</a></td> <td>IMR</td>       <td>Molecule role (INOH Protein name/family name ontology)</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1006</a></td> <td>CL</td>        <td>Cell type</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1053</a></td> <td>FMA</td>       <td>Foundational Model of Anatomy</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1070</a></td> <td>GO</td>        <td>Gene Ontology</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1009</a></td> <td>DOID</td>      <td>Human disease</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1132</a></td> <td>NCBITaxon</td> <td>NCBI organismal classification</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1040</a></td> <td>MI</td>        <td>Protein-protein interaction</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1012</a></td> <td>ECO</td>       <td>Evidence codes</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1123</a></td> <td>OBI</td>       <td>Ontology for Biomedical Investigations</td></tr>
<tr><td><a onclick="addvid(this.innerHTML)" title="click to add">1032</a></td> <td>NCIt</td>      <td>NCI Thesaurus</td></tr>
<tr><td colspan="3"><a onclick="addvid(this.innerHTML)" title="click to add">1109 1062 1029 1006 1053 1070 1009 1132 1040 1012 1123 1032</a> (all above)</td></tr>
</table>
</td></tr>

<tr><td>
Devel <input type="checkbox" name="devel" value="1" />
</td></tr>

<tr>
<td><input type="submit" value="SUBMIT (to call OntoFinder, the remaining process is under development)" style="height: 50px; width: 100%" /></td>
</tr>
</table>
</form>

<script type="text/javascript">
$(function(){
    $('#loading').hide();
});
</script>
</body>
</html>
